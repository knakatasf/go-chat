syntax = "proto3";
option go_package = "./messages";

/* Register a username */
message Registration {
  string username = 1;
}

/* Server/system message (optionally scoped to a room) */
message ServerNotice {
  string text = 1;
  string room = 2; // empty = not scoped to a room
}

/* Rooms */
message RoomJoin {
  string username = 1; // server will ignore/overwrite
  string room     = 2;
}

message RoomLeave {
  string username = 1; // server will ignore/overwrite
  string room     = 2;
}

message RoomChat {
  string username    = 1; // server will overwrite with authenticated user
  string room        = 2;
  string message_body = 3;
}

/* Direct message */
message DirectChat {
  string from         = 1; // server will overwrite
  string to           = 2;
  string message_body = 3;
}

message Wrapper {
  oneof msg {
    Registration registration_message = 1;
    ServerNotice server_notice        = 3;

    RoomJoin     room_join            = 10;
    RoomLeave    room_leave           = 11;
    RoomChat     room_chat            = 12;

    DirectChat   direct_chat          = 20;
  }
}
